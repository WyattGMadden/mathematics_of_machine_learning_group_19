
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Lab 2 - Wyatt Madden \& Dan Crowley}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{3.1}\label{section}

\subsection{1}\label{section-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{io} \PY{k}{as} \PY{n+nn}{scipy}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        
        \PY{k}{def} \PY{n+nf}{gaussian}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
            \PY{n}{mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}
            \PY{n}{x\PYZus{}cent} \PY{o}{=} \PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{mean}
            \PY{n}{var} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{n}{x\PYZus{}cent}\PY{p}{)}\PY{p}{,} \PY{n}{x\PYZus{}cent}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}
            \PY{n}{sd} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{var}\PY{p}{)}
            \PY{k}{return} \PY{n}{mean}\PY{p}{,} \PY{n}{sd}
\end{Verbatim}


    \subsection{2}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{mat} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{loadmat}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/wyattmadden/Documents/school/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} 
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSU/2020/m508/labs/lab\PYZus{}2/employees.mat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dept} \PY{o}{=} \PY{n}{mat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{sal} \PY{o}{=} \PY{n}{mat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{depts} \PY{o}{=} \PY{n}{mat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depts}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsection{3}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{dept}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{dept}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,}\PY{p}{]} \PY{o}{=} \PY{n}{gaussian}\PY{p}{(}\PY{n}{sal}\PY{p}{[}\PY{n}{dept} \PY{o}{==} \PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+}  \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ has mean salary \PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                    \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{+} 
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ with standard deviation }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                    \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Department 1 has mean salary \$82287.46 with standard deviation 15880.04.
Department 2 has mean salary \$76925.82 with standard deviation 20624.72.
Department 3 has mean salary \$80859.86 with standard deviation 19905.39.
Department 4 has mean salary \$56850.31 with standard deviation 29301.85.
Department 5 has mean salary \$70260.79 with standard deviation 11694.93.
Department 6 has mean salary \$70665.27 with standard deviation 20390.71.
Department 7 has mean salary \$88247.96 with standard deviation 17844.79.
Department 8 has mean salary \$38635.3 with standard deviation 35090.32.
Department 9 has mean salary \$82412.05 with standard deviation 21556.95.
Department 10 has mean salary \$72114.07 with standard deviation 20541.12.
Department 11 has mean salary \$53791.29 with standard deviation 28718.84.
Department 12 has mean salary \$79869.23 with standard deviation 15285.17.
Department 13 has mean salary \$77601.17 with standard deviation 21205.31.
Department 14 has mean salary \$86765.19 with standard deviation 42916.64.
Department 15 has mean salary \$70746.43 with standard deviation 32566.51.
Department 16 has mean salary \$51374.8 with standard deviation 27382.34.
Department 17 has mean salary \$68608.02 with standard deviation 23099.5.
Department 18 has mean salary \$77374.0 with standard deviation 25558.81.
Department 19 has mean salary \$81502.14 with standard deviation 19910.38.
Department 20 has mean salary \$91814.51 with standard deviation 16216.65.
Department 21 has mean salary \$77989.61 with standard deviation 22802.56.
Department 22 has mean salary \$53674.78 with standard deviation 21554.3.
Department 23 has mean salary \$57845.33 with standard deviation 25742.33.
Department 24 has mean salary \$55953.41 with standard deviation 25257.26.
Department 25 has mean salary \$84022.27 with standard deviation 24695.37.
Department 26 has mean salary \$80614.71 with standard deviation 28332.72.
Department 27 has mean salary \$73565.24 with standard deviation 24157.16.
Department 28 has mean salary \$70678.85 with standard deviation 24813.14.
Department 29 has mean salary \$94083.53 with standard deviation 16818.53.
Department 30 has mean salary \$85095.33 with standard deviation 15805.28.
Department 31 has mean salary \$79786.04 with standard deviation 23112.75.
Department 32 has mean salary \$82334.67 with standard deviation 25587.57.
Department 33 has mean salary \$79068.0 with standard deviation 18660.0.
Department 34 has mean salary \$71112.9 with standard deviation 22474.83.

    \end{Verbatim}

    \subsection{4}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} 
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ has the maximum mean salary of \PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} 
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ has the minimum mean salary of \PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Department 29 has the maximum mean salary of \$94083.53
Department 8 has the minimum mean salary of \$38635.3

    \end{Verbatim}

    \subsection{5}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} 
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ has the maximum variance of }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} 
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ has the minimum variance of }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Department 14 has the maximum variance of 1841837960.84
Department 5 has the minimum variance of 136771290.8

    \end{Verbatim}

    Hard to say if there is yet a "pattern", however it's interesting that
the minimum variance and minimum mean are both from a departmenet
labeled with a smaller integer, while the maximum variance and maximum
mean are both from a department labeled with a larger integer.

    \subsection{6}\label{section}

First let us define a gaussian density function, and then calculate the
density at 10,000 for each of the department specific parameter
combinations.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}185}]:} \PY{k}{def} \PY{n+nf}{gaussian\PYZus{}density}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{mean}\PY{p}{,} \PY{n}{sd}\PY{p}{)}\PY{p}{:}
              \PY{k}{return} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{n}{sd}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{mean}\PY{p}{)}\PY{o}{/}\PY{n}{sd}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{n}{point\PYZus{}densities} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{dept}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{means} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{]}
          \PY{n}{sds} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{mean\PYZus{}sd\PYZus{}by\PYZus{}dept}\PY{p}{]}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{point\PYZus{}densities}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{point\PYZus{}densities}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{gaussian\PYZus{}density}\PY{p}{(}\PY{l+m+mi}{10000}\PY{p}{,} \PY{n}{means}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{sds}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{point\PYZus{}densities}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+}
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ is least likely to pay someone \PYZdl{}10000 per year.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Department }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{point\PYZus{}densities}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+}
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ is most likely to pay someone \PYZdl{}10000 per year.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Department 5 is least likely to pay someone \$10000 per year.
Department 8 is most likely to pay someone \$10000 per year.

    \end{Verbatim}

    \section{3.2}\label{section}

\subsection{1}\label{section-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{c+c1}{\PYZsh{} Create Lat\PYZhy{}Long Grid}
         \PY{c+c1}{\PYZsh{}   from lat long coordinates, create grid of points}
         \PY{c+c1}{\PYZsh{} Input:}
         \PY{c+c1}{\PYZsh{}   lat: 1D vector of lat coords}
         \PY{c+c1}{\PYZsh{}   lon: 1D vector of long coords}
         \PY{c+c1}{\PYZsh{}   dims: length/width of grid}
         \PY{c+c1}{\PYZsh{} Output:}
         \PY{c+c1}{\PYZsh{}   C: 2D array of lat long grid coords}
         
         \PY{k}{def} \PY{n+nf}{lat\PYZus{}lon\PYZus{}grid}\PY{p}{(}\PY{n}{lat}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{dims}\PY{p}{)}\PY{p}{:}
             \PY{n}{lat\PYZus{}max} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lat}\PY{p}{)}
             \PY{n}{lat\PYZus{}min} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lat}\PY{p}{)}
             \PY{n}{lon\PYZus{}max} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lon}\PY{p}{)}
             \PY{n}{lon\PYZus{}min} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lon}\PY{p}{)}
             \PY{n}{lat\PYZus{}seq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{lat\PYZus{}min}\PY{p}{,} \PY{n}{lat\PYZus{}max}\PY{p}{,} \PY{n}{dims}\PY{p}{)}
             \PY{n}{lon\PYZus{}seq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{lon\PYZus{}min}\PY{p}{,} \PY{n}{lon\PYZus{}max}\PY{p}{,} \PY{n}{dims}\PY{p}{)}
             \PY{n}{lat\PYZus{}grid}\PY{p}{,} \PY{n}{lon\PYZus{}grid} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{lat\PYZus{}seq}\PY{p}{,} \PY{n}{lon\PYZus{}seq}\PY{p}{)}
             \PY{n}{lat\PYZus{}vect} \PY{o}{=} \PY{n}{lat\PYZus{}grid}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
             \PY{n}{lon\PYZus{}vect} \PY{o}{=} \PY{n}{lon\PYZus{}grid}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
             \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{lat\PYZus{}vect}\PY{p}{,} \PY{n}{lon\PYZus{}vect}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}176}]:} \PY{c+c1}{\PYZsh{} def kde(X, h, C):}
          
          \PY{c+c1}{\PYZsh{} Kernel Density Estimation}
          \PY{c+c1}{\PYZsh{}   Samples the kernel density estimate of a probability distribution using the}
          \PY{c+c1}{\PYZsh{}  data in X with Gaussian kernel of standard deviation h. Samples are calculated}
          \PY{c+c1}{\PYZsh{}  for each location in C.}
          \PY{c+c1}{\PYZsh{} Input:}
          \PY{c+c1}{\PYZsh{}   X \PYZhy{} A D\PYZhy{}by\PYZhy{}N matrix with observation locations in each column (thus the}
          \PY{c+c1}{\PYZsh{}   	observations are in D\PYZhy{}dimensions and there are N of them).}
          \PY{c+c1}{\PYZsh{}   h \PYZhy{} A number indicating the standard deviation of the Gaussian kernel used.}
          \PY{c+c1}{\PYZsh{}   C \PYZhy{} Locations to evaluate the estimated distribution. Hence D\PYZhy{}by\PYZhy{}M, where if }
          \PY{c+c1}{\PYZsh{}      M = 1 this function calculates the KDE at one location.}
          \PY{c+c1}{\PYZsh{} Output:}
          \PY{c+c1}{\PYZsh{}   E \PYZhy{} Evaluation of the estimated distribution at each of M locations given by }
          \PY{c+c1}{\PYZsh{}      the input C. Should be returned as a column vector.}
          
          \PY{c+c1}{\PYZsh{} def kde(X, h, C):}
          
          \PY{k}{def} \PY{n+nf}{kde}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{h}\PY{p}{,} \PY{n}{C}\PY{p}{)}\PY{p}{:}
              \PY{n}{kde\PYZus{}mass\PYZus{}vector} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{C}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
              
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{C}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{data\PYZus{}to\PYZus{}gridpoint\PYZus{}distances} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diagonal}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{X} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} 
                                                                      \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{n}{X} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                  \PY{n}{gaus\PYZus{}kern} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{data\PYZus{}to\PYZus{}gridpoint\PYZus{}distances} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{p}{(}\PY{n}{h}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                  \PY{n}{point\PYZus{}masses} \PY{o}{=} \PY{n}{gaus\PYZus{}kern} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{h}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
                  \PY{n}{kde\PYZus{}mass\PYZus{}vector}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{point\PYZus{}masses}\PY{p}{)} \PY{o}{/} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
              
              \PY{k}{return} \PY{n}{kde\PYZus{}mass\PYZus{}vector}
\end{Verbatim}


    \section{2}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}177}]:} \PY{n}{mat\PYZus{}crimes} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{loadmat}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/wyattmadden/Documents/school/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} 
                                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSU/2020/m508/labs/lab\PYZus{}2/crimes.mat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                     \PY{n}{squeeze\PYZus{}me} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          \PY{n}{type\PYZus{}crime} \PY{o}{=} \PY{n}{mat\PYZus{}crimes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{year} \PY{o}{=} \PY{n}{mat\PYZus{}crimes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{lat} \PY{o}{=} \PY{n}{mat\PYZus{}crimes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{lon} \PY{o}{=} \PY{n}{mat\PYZus{}crimes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsection{3}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}209}]:} \PY{n}{lat\PYZus{}15\PYZus{}2014} \PY{o}{=} \PY{n}{lat}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2014}\PY{p}{)}\PY{p}{]}
          \PY{n}{lon\PYZus{}15\PYZus{}2014} \PY{o}{=} \PY{n}{lon}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2014}\PY{p}{)}\PY{p}{]}
          
          \PY{n}{coord\PYZus{}grid} \PY{o}{=} \PY{n}{lat\PYZus{}lon\PYZus{}grid}\PY{p}{(}\PY{n}{lat\PYZus{}15\PYZus{}2014}\PY{p}{,} \PY{n}{lon\PYZus{}15\PYZus{}2014}\PY{p}{,} \PY{n}{dims} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}
          
          \PY{n}{mass\PYZus{}temp} \PY{o}{=} \PY{n}{kde}\PY{p}{(}\PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{lat\PYZus{}15\PYZus{}2014}\PY{p}{,} \PY{n}{lon\PYZus{}15\PYZus{}2014}\PY{p}{]}\PY{p}{,}
                          \PY{n}{h} \PY{o}{=} \PY{l+m+mf}{0.01}\PY{p}{,} 
                          \PY{n}{C} \PY{o}{=} \PY{n}{coord\PYZus{}grid}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}210}]:} \PY{c+c1}{\PYZsh{}plot}
          \PY{n}{lat\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
          \PY{n}{lon\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
          
          \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
          \PY{n}{points} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{lon\PYZus{}grid}\PY{p}{,} \PY{n}{lat\PYZus{}grid}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{mass\PYZus{}temp}\PY{p}{,} \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{)}
          \PY{n}{f}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{points}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2014, Crime Type 15}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}210}]:} Text(0.5,1,'2014, Crime Type 15')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{4}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}193}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2001}\PY{p}{,} \PY{l+m+mi}{2015}\PY{p}{)}\PY{p}{:}
              \PY{n}{lat\PYZus{}15\PYZus{}general} \PY{o}{=} \PY{n}{lat}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{n}{i}\PY{p}{)}\PY{p}{]}
              \PY{n}{lon\PYZus{}15\PYZus{}general} \PY{o}{=} \PY{n}{lon}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{n}{i}\PY{p}{)}\PY{p}{]}
              
              \PY{n}{coord\PYZus{}grid} \PY{o}{=} \PY{n}{lat\PYZus{}lon\PYZus{}grid}\PY{p}{(}\PY{n}{lat\PYZus{}15\PYZus{}2014}\PY{p}{,} \PY{n}{lon\PYZus{}15\PYZus{}2014}\PY{p}{,} \PY{n}{dims} \PY{o}{=} \PY{l+m+mi}{75}\PY{p}{)}
              
              \PY{n}{mass\PYZus{}temp} \PY{o}{=} \PY{n}{kde}\PY{p}{(}\PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{lat\PYZus{}15\PYZus{}general}\PY{p}{,} \PY{n}{lon\PYZus{}15\PYZus{}general}\PY{p}{]}\PY{p}{,}
                              \PY{n}{h} \PY{o}{=} \PY{l+m+mf}{0.01}\PY{p}{,} 
                              \PY{n}{C} \PY{o}{=} \PY{n}{coord\PYZus{}grid}\PY{p}{)}
              \PY{c+c1}{\PYZsh{}plot}
              \PY{n}{lat\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
              \PY{n}{lon\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
          
              \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
              \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
              \PY{n}{points} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{lon\PYZus{}grid}\PY{p}{,} \PY{n}{lat\PYZus{}grid}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{mass\PYZus{}temp}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{)}
              \PY{n}{f}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{points}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, Crime Type 15}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
              
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{5}\label{section}

While the distribution of Chicagoan gambling crimes is relatively
constant across years, and least in terms of boundaries, there does
appear to be a shift in intensity of gambling crimes in the northwestern
neighborhoods when compared to the southeastern neighborhoods.
Specifically, in early years the intensity of gambling crimes between
these two areas appears similar, while in later years the intensity in
the southeastern neighborhoods appears diminished in comparison to the
northwestern neighborhoods.

It also appears that overall, gambling crimes are going up across years,
at least when comparing the highest intensity neighborhoods within each
year.

    \subsection{6}\label{section}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}211}]:} \PY{n}{lat\PYZus{}1\PYZus{}2014} \PY{o}{=} \PY{n}{lat}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2014}\PY{p}{)}\PY{p}{]}
          \PY{n}{lon\PYZus{}1\PYZus{}2014} \PY{o}{=} \PY{n}{lon}\PY{p}{[}\PY{p}{(}\PY{n}{type\PYZus{}crime} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2014}\PY{p}{)}\PY{p}{]}
          
          \PY{n}{coord\PYZus{}grid} \PY{o}{=} \PY{n}{lat\PYZus{}lon\PYZus{}grid}\PY{p}{(}\PY{n}{lat\PYZus{}1\PYZus{}2014}\PY{p}{,} \PY{n}{lon\PYZus{}1\PYZus{}2014}\PY{p}{,} \PY{n}{dims} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}
          
          \PY{n}{mass\PYZus{}temp} \PY{o}{=} \PY{n}{kde}\PY{p}{(}\PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{lat\PYZus{}1\PYZus{}2014}\PY{p}{,} \PY{n}{lon\PYZus{}1\PYZus{}2014}\PY{p}{]}\PY{p}{,}
                          \PY{n}{h} \PY{o}{=} \PY{l+m+mf}{0.01}\PY{p}{,} 
                          \PY{n}{C} \PY{o}{=} \PY{n}{coord\PYZus{}grid}\PY{p}{)}
          
          
          \PY{c+c1}{\PYZsh{}plot}
          \PY{n}{lat\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
          \PY{n}{lon\PYZus{}grid} \PY{o}{=} \PY{p}{[}\PY{n}{param}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{param} \PY{o+ow}{in} \PY{n}{coord\PYZus{}grid}\PY{p}{]}
          
          \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{cubehelix\PYZus{}palette}\PY{p}{(}\PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
          \PY{n}{points} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{lon\PYZus{}grid}\PY{p}{,} \PY{n}{lat\PYZus{}grid}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{mass\PYZus{}temp}\PY{p}{,} \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{)}
          \PY{n}{f}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{points}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2014, Crime Type 1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}211}]:} Text(0.5,1,'2014, Crime Type 15')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{4}\label{section}

\subsection{1}\label{section-1}

This means that the model could likely be improved to better match the
context. We would likely want to alter the density kernal. An
alternative "smooth" kernal could be a truncated normal, with the zero
probability density on values less than zero.

\subsection{2}\label{section-2}

The kernal density estimation does not account for natural borders, such
as coastlines, and thus predicts positive probability of crime in Lake
Michigan. While the probability of lake-crime may be non-zero, we would
likely want to account for "lake" effect on crime (ie. the fact that a
crime is much less likely to occur in a lake), possibly by including a
dummy variable predictor indicating whether the location is in a lake or
not.

    An alternative way to generate the charts in python is presented below.
We took a look at manipulating H and thought about bias/variance
tradeoff a little bit for predictions. Wish there was a more sensible
way to hone in on an 'optimal' value of H, more to learn in the future!

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{}3.2 Kernal density estimation }
        \PY{c+c1}{\PYZsh{}define KDE function}
        \PY{k}{def} \PY{n+nf}{KDE}\PY{p}{(}\PY{n}{lat\PYZus{}a}\PY{p}{,} \PY{n}{lon\PYZus{}a}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{h}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{}for a single location }
            \PY{c+c1}{\PYZsh{}euclidean distance of point 1 with all other points}
            \PY{n}{N} \PY{o}{=} \PY{n}{lat}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{n}{E} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{n}{N}\PY{p}{)}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}lat\PYZus{}a = lat[i]}
            \PY{c+c1}{\PYZsh{}lat\PYZus{}b = lon[i]}
            \PY{n}{distance} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{p}{(}\PY{n}{lat\PYZus{}a} \PY{o}{\PYZhy{}} \PY{n}{lat}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n}{lon\PYZus{}a}\PY{o}{\PYZhy{}}\PY{n}{lon}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
            \PY{n}{E} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{N}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{*} \PY{n}{h}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{*}\PY{p}{(}\PY{n}{h}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{distance}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
            \PY{k}{return} \PY{n}{E}
        \PY{n}{crime} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{loadmat}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/wyattmadden/Documents/school/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} 
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSU/2020/m508/labs/lab\PYZus{}2/crimes.mat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{n}{lat} \PY{o}{=} \PY{n}{crime}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{lon} \PY{o}{=} \PY{n}{crime}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{year} \PY{o}{=} \PY{n}{crime}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n+nb}{type} \PY{o}{=} \PY{n}{crime}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{h} \PY{o}{=} \PY{l+m+mi}{1}
        \PY{c+c1}{\PYZsh{}test function}
        \PY{n}{KDE}\PY{p}{(}\PY{n}{lat\PYZus{}a} \PY{o}{=} \PY{n}{lat}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{lon\PYZus{}a} \PY{o}{=} \PY{n}{lon}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{lat} \PY{o}{=} \PY{n}{lat}\PY{p}{,} \PY{n}{lon} \PY{o}{=} \PY{n}{lon}\PY{p}{,} \PY{n}{h} \PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}great, works}
        \PY{k}{def} \PY{n+nf}{KDE\PYZus{}map}\PY{p}{(}\PY{n}{points}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{h}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}points}
            \PY{n}{density} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{n}{points}\PY{p}{,}\PY{n}{points}\PY{p}{)}\PY{p}{)}
            \PY{n}{lat\PYZus{}unif} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{lat}\PY{p}{)}\PY{p}{,} \PY{n+nb}{min}\PY{p}{(}\PY{n}{lat}\PY{p}{)}\PY{p}{,} \PY{n}{points}\PY{p}{)} \PY{c+c1}{\PYZsh{}go from largest to smallest, we want the larger values coming at the top of the graph}
            \PY{n}{lon\PYZus{}unif} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{n}{lon}\PY{p}{)}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{lon}\PY{p}{)}\PY{p}{,} \PY{n}{points}\PY{p}{)} \PY{c+c1}{\PYZsh{}go from smallest to largest, we want the larger, less negative values, coming later}
            \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{points}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{}print(j)}
                \PY{n}{lat\PYZus{}index} \PY{o}{=} \PY{n}{lat\PYZus{}unif}\PY{p}{[}\PY{n}{j}\PY{p}{]}
                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{points}\PY{p}{)}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{}index density by lat first, then lon}
                    \PY{c+c1}{\PYZsh{}python goes matrix[columns, rows], and we want our columns to be latitudes}
                    \PY{n}{density}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{KDE}\PY{p}{(}\PY{n}{lat\PYZus{}a} \PY{o}{=} \PY{n}{lat\PYZus{}index}\PY{p}{,} \PY{n}{lon\PYZus{}a} \PY{o}{=} \PY{n}{lon\PYZus{}unif}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{lat} \PY{o}{=} \PY{n}{lat}\PY{p}{,} \PY{n}{lon} \PY{o}{=} \PY{n}{lon}\PY{p}{,} \PY{n}{h} \PY{o}{=} \PY{n}{h}\PY{p}{)}
            \PY{k}{return}\PY{p}{(}\PY{n}{density}\PY{p}{)}
            
        \PY{c+c1}{\PYZsh{}create data}
        \PY{n}{lat} \PY{o}{=} \PY{n}{lat}\PY{p}{[}\PY{n+nb}{type} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{]}
        \PY{n}{lon} \PY{o}{=} \PY{n}{lon}\PY{p}{[}\PY{n+nb}{type} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{]}
        \PY{n}{year} \PY{o}{=} \PY{n}{year}\PY{p}{[}\PY{n+nb}{type} \PY{o}{==} \PY{l+m+mi}{15}\PY{p}{]}
        \PY{n}{points} \PY{o}{=} \PY{l+m+mi}{100}
        
        \PY{c+c1}{\PYZsh{}which bear h is besttttttttttt }
        \PY{n}{density} \PY{o}{=} \PY{n}{KDE\PYZus{}map}\PY{p}{(}\PY{n}{points}\PY{p}{,} \PY{n}{lat}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{lon}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{h} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{density}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} <matplotlib.image.AxesImage at 0x106960c18>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{density} \PY{o}{=} \PY{n}{KDE\PYZus{}map}\PY{p}{(}\PY{n}{points}\PY{p}{,} \PY{n}{lat}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{lon}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{h} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{density}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:} <matplotlib.image.AxesImage at 0x1a0d6270f0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{density} \PY{o}{=} \PY{n}{KDE\PYZus{}map}\PY{p}{(}\PY{n}{points}\PY{p}{,} \PY{n}{lat}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{lon}\PY{p}{[}\PY{n}{year} \PY{o}{==} \PY{l+m+mi}{2013}\PY{p}{]}\PY{p}{,} \PY{n}{h} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{density}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{n}{points}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} <matplotlib.image.AxesImage at 0x1a0d747748>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_30_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
